import{appendToQueryString as t,getQueryString as e,parseWalletConnectUri as n,isBrowser as i,getLocation as o,detectEnv as r,getLocal as s,setLocal as c,removeLocal as h,getClientMeta as a}from"@deficonnect/utils";import"regenerator-runtime/runtime";import u from"@deficonnect/web3-provider";import d from"@deficonnect/core";import*as l from"@deficonnect/iso-crypto";import{pubkeyType as f}from"@cosmjs/amino";import{fromBase64 as p,toBase64 as g}from"@cosmjs/encoding";import{TxBody as v,AuthInfo as w,TxRaw as m}from"cosmjs-types/cosmos/tx/v1beta1/tx";import{isTsProtoGeneratedType as y}from"@cosmjs/proto-signing";import{defaultRegistryTypes as _}from"@cosmjs/stargate";import{InjectedConnector as b}from"@web3-react/injected-connector";var E,C="object"==typeof Reflect?Reflect:null,S=C&&"function"==typeof C.apply?C.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};E=C&&"function"==typeof C.ownKeys?C.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var k=Number.isNaN||function(t){return t!=t};function O(){O.init.call(this)}var I=O;O.EventEmitter=O,O.prototype._events=void 0,O.prototype._eventsCount=0,O.prototype._maxListeners=void 0;var L,N=10;function T(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function x(t){return void 0===t._maxListeners?O.defaultMaxListeners:t._maxListeners}function W(t,e,n,i){var o,r,s;if(T(n),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),s=r[e]),void 0===s)s=r[e]=n,++t._eventsCount;else if("function"==typeof s?s=r[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(o=x(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,console&&console.warn&&console.warn(c)}return t}function B(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function A(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=B.bind(i);return o.listener=n,i.wrapFn=o,o}function j(t,e,n){var i=t._events;if(void 0===i)return[];var o=i[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):q(o,o.length)}function M(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function q(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function U(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function o(r){i.once&&t.removeEventListener(e,o),n(r)})}}Object.defineProperty(O,"defaultMaxListeners",{enumerable:!0,get:function(){return N},set:function(t){if("number"!=typeof t||t<0||k(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");N=t}}),O.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},O.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||k(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},O.prototype.getMaxListeners=function(){return x(this)},O.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var r;if(e.length>0&&(r=e[0]),r instanceof Error)throw r;var s=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw s.context=r,s}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)S(c,this,e);else{var h=c.length,a=q(c,h);for(n=0;n<h;++n)S(a[n],this,e)}return!0},O.prototype.on=O.prototype.addListener=function(t,e){return W(this,t,e,!1)},O.prototype.prependListener=function(t,e){return W(this,t,e,!0)},O.prototype.once=function(t,e){return T(e),this.on(t,A(this,t,e)),this},O.prototype.prependOnceListener=function(t,e){return T(e),this.prependListener(t,A(this,t,e)),this},O.prototype.off=O.prototype.removeListener=function(t,e){var n,i,o,r,s;if(T(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===e||n[r].listener===e){s=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},O.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},O.prototype.listeners=function(t){return j(this,t,!0)},O.prototype.rawListeners=function(t){return j(this,t,!1)},O.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):M.call(t,e)},O.prototype.listenerCount=M,O.prototype.eventNames=function(){return this._eventsCount>0?E(this._events):[]},I.once=function(t,e){return new Promise(function(n,i){function o(n){t.removeListener(e,r),i(n)}function r(){"function"==typeof t.removeListener&&t.removeListener("error",o),n([].slice.call(arguments))}U(t,e,r,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&U(t,"error",e,{once:!0})}(t,o)})},function(t){t.Update="Web3ReactUpdate",t.Error="Web3ReactError",t.Deactivate="Web3ReactDeactivate"}(L||(L={}));var P=
/*#__PURE__*/
function(t){var e,n;function i(e){var n,i=(void 0===e?{}:e).supportedChainIds;return(n=t.call(this)||this).supportedChainIds=i,n}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=i.prototype;return o.emitUpdate=function(t){"production"!==process.env.NODE_ENV&&console.log("Emitting '"+L.Update+"' with payload",t),this.emit(L.Update,t)},o.emitError=function(t){"production"!==process.env.NODE_ENV&&console.log("Emitting '"+L.Error+"' with payload",t),this.emit(L.Error,t)},o.emitDeactivate=function(){"production"!==process.env.NODE_ENV&&console.log("Emitting '"+L.Deactivate+"'"),this.emit(L.Deactivate)},i}(I.EventEmitter);function D(){return D=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},D.apply(this,arguments)}const R=t=>t&&0!==t.length?t.split("?")[0]:t,$=(n,i)=>{if(!n||0===n.length)return n;const o=n.split("?"),r=t("?"+e(o[1]||""),i);return o[0]+"?"+r},F=(t,e)=>{const i=n(t),o=encodeURIComponent($(decodeURIComponent(i.bridge),e));return`${i.protocol}:${i.handshakeTopic}@${i.version}?bridge=${o}&key=${i.key}`},V=(t,e)=>{const i=n(t),o=encodeURIComponent(R(decodeURIComponent(i.bridge)));return`${e}:${i.handshakeTopic}@${i.version}?bridge=${o}&key=${i.key}`},G=t=>V(t,"CWE"),Z=t=>V(t,"wc"),J=(t,e=20)=>{let n=t;return n=n.substr(0,e)+(n.length>e?"...":""),n};class K{constructor(){this._eventEmitters=[],"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",()=>this.trigger("online")),window.addEventListener("offline",()=>this.trigger("offline")))}on(t,e){this._eventEmitters.push({event:t,callback:e})}trigger(t){let e=[];t&&(e=this._eventEmitters.filter(e=>e.event===t)),e.forEach(t=>{t.callback()})}}const Q=void 0!==global.WebSocket?global.WebSocket:require("ws");class X{constructor(t){if(this.opts=t,this._queue=[],this._events=[],this._subscriptions=[],this._protocol=t.protocol,this._version=t.version,this._url="",this._netMonitor=null,this._socket=null,this._nextSocket=null,this._subscriptions=t.subscriptions||[],this._netMonitor=t.netMonitor||new K,!t.url||"string"!=typeof t.url)throw new Error("Missing or invalid WebSocket url");this._url=t.url,this._netMonitor.on("online",()=>this._socketCreate())}set readyState(t){}get readyState(){return this._socket?this._socket.readyState:-1}set connecting(t){}get connecting(){return 0===this.readyState}set connected(t){}get connected(){return 1===this.readyState}set closing(t){}get closing(){return 2===this.readyState}set closed(t){}get closed(){return 3===this.readyState}open(){this._socketCreate()}close(){this._socketClose()}send(t,e,n){if(!e||"string"!=typeof e)throw new Error("Missing or invalid topic field");this._socketSend({topic:e,type:"pub",payload:t,silent:!!n})}subscribe(t){this._socketSend({topic:t,type:"sub",payload:"",silent:!0})}on(t,e){this._events.push({event:t,callback:e})}_socketCreate(){if(this._nextSocket)return;const n=function(n,s,c){var h,a;const u=(n.startsWith("https")?n.replace("https","wss"):n.startsWith("http")?n.replace("http","ws"):n).split("?"),d=i()?{protocol:s,version:c,env:"browser",host:(null===(h=o())||void 0===h?void 0:h.host)||""}:{protocol:s,version:c,env:(null===(a=r())||void 0===a?void 0:a.name)||""},l=t(e("?"+(u[1]||"")),d);return u[0]+"?"+l}(this._url,this._protocol,this._version);if(this._nextSocket=new Q(n),!this._nextSocket)throw new Error("Failed to create socket");this._nextSocket.onmessage=t=>this._socketReceive(t),this._nextSocket.onopen=()=>this._socketOpen(),this._nextSocket.onerror=t=>this._socketError(t),this._nextSocket.onclose=()=>{setTimeout(()=>{this._nextSocket=null,this._socketCreate()},1e3)}}_socketOpen(){this._socketClose(),this._socket=this._nextSocket,this._nextSocket=null,this._queueSubscriptions(),this._pushQueue()}_socketClose(){this._socket&&(this._socket.onclose=()=>{},this._socket.close())}_socketSend(t){const e=JSON.stringify(t);this._socket&&1===this._socket.readyState?this._socket.send(e):(this._setToQueue(t),this._socketCreate())}async _socketReceive(t){let e;try{e=JSON.parse(t.data)}catch(t){return}if(this._socketSend({topic:e.topic,type:"ack",payload:"",silent:!0}),this._socket&&1===this._socket.readyState){const t=this._events.filter(t=>"message"===t.event);t&&t.length&&t.forEach(t=>t.callback(e))}}_socketError(t){const e=this._events.filter(t=>"error"===t.event);e&&e.length&&e.forEach(e=>e.callback(t))}_queueSubscriptions(){this._subscriptions.forEach(t=>this._queue.push({topic:t,type:"sub",payload:"",silent:!0})),this._subscriptions=this.opts.subscriptions||[]}_setToQueue(t){this._queue.push(t)}_pushQueue(){this._queue.forEach(t=>this._socketSend(t)),this._queue=[]}}class z{constructor(t){var e;this.connector=void 0,this.transport=void 0,this.sessionStorage=void 0;const{connectorOpts:i,sessionStorage:o,exists:r}=t;this.sessionStorage=o;const s=(null==i?void 0:i.session)||(null==o?void 0:o.getSession());let c,h,a=null!=(e=null==i?void 0:i.bridge)?e:null==s?void 0:s.bridge;if(!a&&null!=i&&i.uri&&(a=n(i.uri).bridge),r?c=r.transport:a&&(c=new X({protocol:"wc",version:3,url:a})),!c)throw new Error("bridge can not be null");if(r?h=r.connector:i&&(h=new d({cryptoLib:l,connectorOpts:i,sessionStorage:o,transport:c})),!h)throw new Error("connectorOpts can not be null");this.connector=h,this.transport=c,this.transport.subscribe(h.clientId)}clearSessionStorage(){var t;this.sessionStorage?this.sessionStorage.removeSession():null==(t=this.connector._sessionStorage)||t.removeSession()}}function H(t){var e={exports:{}};return t(e,e.exports),e.exports}var Y=H(function(t,e){function n(t){let e;return"undefined"!=typeof window&&void 0!==window[t]&&(e=window[t]),e}function i(t){const e=n(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getLocalStorage=e.getLocalStorageOrThrow=e.getCrypto=e.getCryptoOrThrow=e.getLocation=e.getLocationOrThrow=e.getNavigator=e.getNavigatorOrThrow=e.getDocument=e.getDocumentOrThrow=e.getFromWindowOrThrow=e.getFromWindow=void 0,e.getFromWindow=n,e.getFromWindowOrThrow=i,e.getDocumentOrThrow=function(){return i("document")},e.getDocument=function(){return n("document")},e.getNavigatorOrThrow=function(){return i("navigator")},e.getNavigator=function(){return n("navigator")},e.getLocationOrThrow=function(){return i("location")},e.getLocation=function(){return n("location")},e.getCryptoOrThrow=function(){return i("crypto")},e.getCrypto=function(){return n("crypto")},e.getLocalStorageOrThrow=function(){return i("localStorage")},e.getLocalStorage=function(){return n("localStorage")}});H(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getWindowMetadata=void 0,e.getWindowMetadata=function(){let t,e;try{t=Y.getDocumentOrThrow(),e=Y.getLocationOrThrow()}catch(t){return null}function n(...e){const n=t.getElementsByTagName("meta");for(let t=0;t<n.length;t++){const i=n[t],o=["itemprop","property","name"].map(t=>i.getAttribute(t)).filter(t=>!!t&&e.includes(t));if(o.length&&o){const t=i.getAttribute("content");if(t)return t}}return""}const i=function(){let e=n("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}();return{description:n("description","og:description","twitter:description","keywords"),url:e.origin,icons:function(){const n=t.getElementsByTagName("link"),i=[];for(let t=0;t<n.length;t++){const o=n[t],r=o.getAttribute("rel");if(r&&r.toLowerCase().indexOf("icon")>-1){const t=o.getAttribute("href");if(t)if(-1===t.toLowerCase().indexOf("https:")&&-1===t.toLowerCase().indexOf("http:")&&0!==t.indexOf("//")){let n=e.protocol+"//"+e.host;if(0===t.indexOf("/"))n+=t;else{const i=e.pathname.split("/");i.pop(),n+=i.join("/")+"/"+t}i.push(n)}else 0===t.indexOf("//")?i.push(e.protocol+t):i.push(t)}}return i}(),name:i}}});var tt=function(t,e,n){this.name=t,this.version=e,this.os=n,this.type="browser"},et=function(t){this.version=t,this.type="node",this.name="node",this.os=process.platform},nt=function(t,e,n,i){this.name=t,this.version=e,this.os=n,this.bot=i,this.type="bot-device"},it=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},ot=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},rt=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,st=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],ct=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ht(){const t="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new ot:"undefined"!=typeof navigator?function(t){var e=function(t){return""!==t&&st.reduce(function(e,n){var i=n[0];if(e)return e;var o=n[1].exec(t);return!!o&&[i,o]},!1)}(t);if(!e)return null;var n=e[0],i=e[1];if("searchbot"===n)return new it;var o=i[1]&&i[1].split(/[._]/).slice(0,3);o?o.length<3&&(o=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var r=arguments[e],s=0,c=r.length;s<c;s++,o++)i[o]=r[s];return i}(o,function(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}(3-o.length))):o=[];var r=o.join("."),s=function(t){for(var e=0,n=ct.length;e<n;e++){var i=ct[e],o=i[0];if(i[1].exec(t))return o}return null}(t),c=rt.exec(t);return c&&c[1]?new nt(n,r,s,c[1]):new tt(n,r,s)}(navigator.userAgent):"undefined"!=typeof process&&process.version?new et(process.version.slice(1)):null;return t&&t.os?t.os:void 0}const at={name:"Crypto.com DeFi Wallet",shortName:"DeFi Wallet",color:"rgb(17, 153, 250)",logo:"./logos/wallet-crypto-defi.png",universalLink:"https://wallet.crypto.com",deepLink:"cryptowallet:"},ut={open:async function(t,e,n){const i=G(t)+"&role=dapp";!function(){const t=ht();return!!t&&(t.toLowerCase().includes("ios")||t.toLowerCase().includes("mac")&&navigator.maxTouchPoints>1)}()?function(){const t=ht();return!!t&&t.toLowerCase().includes("android")}()&&V(i,"cwe"):function(t,e){encodeURIComponent(t),e.universalLink||e.deepLink&&e.deepLink.endsWith(":")}(i,at)},close:function(){window.dispatchEvent(new Event("InstallExtensionQRCodeModal_Event_close"))}};var dt=null;try{dt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function lt(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function ft(t){return!0===(t&&t.__isLong__)}Object.defineProperty(lt.prototype,"__isLong__",{value:!0}),lt.isLong=ft;var pt={},gt={};function vt(t,e){var n,i,o;return e?(o=0<=(t>>>=0)&&t<256)&&(i=gt[t])?i:(n=mt(t,(0|t)<0?-1:0,!0),o&&(gt[t]=n),n):(o=-128<=(t|=0)&&t<128)&&(i=pt[t])?i:(n=mt(t,t<0?-1:0,!1),o&&(pt[t]=n),n)}function wt(t,e){if(isNaN(t))return e?It:Ot;if(e){if(t<0)return It;if(t>=Ct)return Wt}else{if(t<=-St)return Bt;if(t+1>=St)return xt}return t<0?wt(-t,e).neg():mt(t%Et|0,t/Et|0,e)}function mt(t,e,n){return new lt(t,e,n)}lt.fromInt=vt,lt.fromNumber=wt,lt.fromBits=mt;var yt=Math.pow;function _t(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return Ot;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var i;if((i=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return _t(t.substring(1),e,n).neg();for(var o=wt(yt(n,8)),r=Ot,s=0;s<t.length;s+=8){var c=Math.min(8,t.length-s),h=parseInt(t.substring(s,s+c),n);if(c<8){var a=wt(yt(n,c));r=r.mul(a).add(wt(h))}else r=(r=r.mul(o)).add(wt(h))}return r.unsigned=e,r}function bt(t,e){return"number"==typeof t?wt(t,e):"string"==typeof t?_t(t,e):mt(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}lt.fromString=_t,lt.fromValue=bt;var Et=4294967296,Ct=Et*Et,St=Ct/2,kt=vt(1<<24),Ot=vt(0);lt.ZERO=Ot;var It=vt(0,!0);lt.UZERO=It;var Lt=vt(1);lt.ONE=Lt;var Nt=vt(1,!0);lt.UONE=Nt;var Tt=vt(-1);lt.NEG_ONE=Tt;var xt=mt(-1,2147483647,!1);lt.MAX_VALUE=xt;var Wt=mt(-1,-1,!0);lt.MAX_UNSIGNED_VALUE=Wt;var Bt=mt(0,-2147483648,!1);lt.MIN_VALUE=Bt;var At=lt.prototype;At.toInt=function(){return this.unsigned?this.low>>>0:this.low},At.toNumber=function(){return this.unsigned?(this.high>>>0)*Et+(this.low>>>0):this.high*Et+(this.low>>>0)},At.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Bt)){var e=wt(t),n=this.div(e),i=n.mul(e).sub(this);return n.toString(t)+i.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=wt(yt(t,6),this.unsigned),r=this,s="";;){var c=r.div(o),h=(r.sub(c.mul(o)).toInt()>>>0).toString(t);if((r=c).isZero())return h+s;for(;h.length<6;)h="0"+h;s=""+h+s}},At.getHighBits=function(){return this.high},At.getHighBitsUnsigned=function(){return this.high>>>0},At.getLowBits=function(){return this.low},At.getLowBitsUnsigned=function(){return this.low>>>0},At.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Bt)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},At.isZero=function(){return 0===this.high&&0===this.low},At.eqz=At.isZero,At.isNegative=function(){return!this.unsigned&&this.high<0},At.isPositive=function(){return this.unsigned||this.high>=0},At.isOdd=function(){return 1==(1&this.low)},At.isEven=function(){return 0==(1&this.low)},At.equals=function(t){return ft(t)||(t=bt(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},At.eq=At.equals,At.notEquals=function(t){return!this.eq(t)},At.neq=At.notEquals,At.ne=At.notEquals,At.lessThan=function(t){return this.comp(t)<0},At.lt=At.lessThan,At.lessThanOrEqual=function(t){return this.comp(t)<=0},At.lte=At.lessThanOrEqual,At.le=At.lessThanOrEqual,At.greaterThan=function(t){return this.comp(t)>0},At.gt=At.greaterThan,At.greaterThanOrEqual=function(t){return this.comp(t)>=0},At.gte=At.greaterThanOrEqual,At.ge=At.greaterThanOrEqual,At.compare=function(t){if(ft(t)||(t=bt(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},At.comp=At.compare,At.negate=function(){return!this.unsigned&&this.eq(Bt)?Bt:this.not().add(Lt)},At.neg=At.negate,At.add=function(t){ft(t)||(t=bt(t));var e=0,n=0,i=0,o=0;return i+=(o+=(65535&this.low)+(65535&t.low))>>>16,n+=(i+=(this.low>>>16)+(t.low>>>16))>>>16,e+=(n+=(65535&this.high)+(65535&t.high))>>>16,e+=(this.high>>>16)+(t.high>>>16),mt((i&=65535)<<16|(o&=65535),(e&=65535)<<16|(n&=65535),this.unsigned)},At.subtract=function(t){return ft(t)||(t=bt(t)),this.add(t.neg())},At.sub=At.subtract,At.multiply=function(t){if(this.isZero())return Ot;if(ft(t)||(t=bt(t)),dt)return mt(dt.mul(this.low,this.high,t.low,t.high),dt.get_high(),this.unsigned);if(t.isZero())return Ot;if(this.eq(Bt))return t.isOdd()?Bt:Ot;if(t.eq(Bt))return this.isOdd()?Bt:Ot;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(kt)&&t.lt(kt))return wt(this.toNumber()*t.toNumber(),this.unsigned);var e=65535&this.high,n=this.low>>>16,i=65535&this.low,o=65535&t.high,r=t.low>>>16,s=65535&t.low,c=0,h=0,a=0,u=0;return a+=(u+=i*s)>>>16,h+=(a+=n*s)>>>16,a&=65535,h+=(a+=i*r)>>>16,c+=(h+=e*s)>>>16,h&=65535,c+=(h+=n*r)>>>16,h&=65535,c+=(h+=i*o)>>>16,c+=(this.high>>>16)*s+e*r+n*o+i*(t.high>>>16),mt((a&=65535)<<16|(u&=65535),(c&=65535)<<16|(h&=65535),this.unsigned)},At.mul=At.multiply,At.divide=function(t){if(ft(t)||(t=bt(t)),t.isZero())throw Error("division by zero");var e,n,i;if(dt)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?mt((this.unsigned?dt.div_u:dt.div_s)(this.low,this.high,t.low,t.high),dt.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?It:Ot;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return It;if(t.gt(this.shru(1)))return Nt;i=It}else{if(this.eq(Bt))return t.eq(Lt)||t.eq(Tt)?Bt:t.eq(Bt)?Lt:(e=this.shr(1).div(t).shl(1)).eq(Ot)?t.isNegative()?Lt:Tt:(n=this.sub(t.mul(e)),i=e.add(n.div(t)));if(t.eq(Bt))return this.unsigned?It:Ot;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=Ot}for(n=this;n.gte(t);){e=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(e)/Math.LN2),r=o<=48?1:yt(2,o-48),s=wt(e),c=s.mul(t);c.isNegative()||c.gt(n);)c=(s=wt(e-=r,this.unsigned)).mul(t);s.isZero()&&(s=Lt),i=i.add(s),n=n.sub(c)}return i},At.div=At.divide,At.modulo=function(t){return ft(t)||(t=bt(t)),dt?mt((this.unsigned?dt.rem_u:dt.rem_s)(this.low,this.high,t.low,t.high),dt.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},At.mod=At.modulo,At.rem=At.modulo,At.not=function(){return mt(~this.low,~this.high,this.unsigned)},At.and=function(t){return ft(t)||(t=bt(t)),mt(this.low&t.low,this.high&t.high,this.unsigned)},At.or=function(t){return ft(t)||(t=bt(t)),mt(this.low|t.low,this.high|t.high,this.unsigned)},At.xor=function(t){return ft(t)||(t=bt(t)),mt(this.low^t.low,this.high^t.high,this.unsigned)},At.shiftLeft=function(t){return ft(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?mt(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):mt(0,this.low<<t-32,this.unsigned)},At.shl=At.shiftLeft,At.shiftRight=function(t){return ft(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?mt(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):mt(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},At.shr=At.shiftRight,At.shiftRightUnsigned=function(t){if(ft(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?mt(this.low>>>t|e<<32-t,e>>>t,this.unsigned):mt(32===t?e:e>>>t-32,0,this.unsigned)},At.shru=At.shiftRightUnsigned,At.shr_u=At.shiftRightUnsigned,At.toSigned=function(){return this.unsigned?mt(this.low,this.high,!1):this},At.toUnsigned=function(){return this.unsigned?this:mt(this.low,this.high,!0)},At.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},At.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},At.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},lt.fromBytes=function(t,e,n){return n?lt.fromBytesLE(t,e):lt.fromBytesBE(t,e)},lt.fromBytesLE=function(t,e){return new lt(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},lt.fromBytesBE=function(t,e){return new lt(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const jt=t=>{const e={};if(t instanceof Array)return t.map(t=>jt(t));if(t&&"string"==typeof t.typeUrl&&"string"==typeof t.value)try{const e=function(t){var e;const n=null==(e=_.find(e=>e[0]===t))?void 0:e[1];if(n&&y(n))return n;throw new Error(`can not find ProtoGeneratedType for typeUrl:${t}`)}(t.typeUrl);return{typeUrl:t.typeUrl,value:jt(e.toJSON(e.decode(p(t.value))))}}catch(e){return t}for(const n in t){const i=t[n];e[n]="object"!=typeof i?i:jt(i)}return e};function Mt(t){return void 0!==t.isDeFiCosmosProvider}class qt{constructor(t){var e=this;this.isDeFiCosmosProvider=!0,this.client=void 0,this.config=void 0,this.sendTransaction=async function(t){const{chainId:n,chainType:i}=e.client.connector.session;return e.client.connector.sendJSONRequest({method:"cosmos_sendTransaction",params:[t],session:{chainId:n,chainType:i,account:e.account}},{forcePushNotification:!0})},this.request=async function(t){},this.send=async function(t,e){},this.stop=async function(){},this.close=async function(){await e.client.connector.killSession(),await e.stop()};const{client:n}=t;this.config=t,this.client=n}get account(){var t;return null!=(t=this.client.connector.session.accounts[0])?t:""}get currentAccountInfo(){const t=Object.entries(this.client.connector.session.wallets[0].addresses).find(([t,e])=>e.address==this.account);return null==t?void 0:t[1]}get signer(){var t,e=this;const n=this.currentAccountInfo;if(!n||!n.pubkey)throw new Error("can not get the OfflineSigner, there is an unsupported address type");const i={address:n.address,algo:"secp256k1",pubkey:p(null!=(t=n.pubkey)?t:"")};return{getAccounts:async function(){return[i]},signDirect:async function(t,n){const o=await e.sendTransaction(((t,e)=>{const n=v.decode(e.bodyBytes),i=w.decode(e.authInfoBytes);return{signerAddress:t,signDoc:{chainId:e.chainId,accountNumber:e.accountNumber.toString(),body:jt(v.toJSON(n)),authInfo:jt(w.toJSON(i))}}})(t,n)),r=m.decode(p(o)),s=g(r.signatures[0]);return{signed:{bodyBytes:r.bodyBytes,authInfoBytes:r.authInfoBytes,chainId:n.chainId,accountNumber:n.accountNumber},signature:{pub_key:{type:f.secp256k1,value:i.pubkey},signature:s}}}}}async enable(){return this.client.connector.connected||await this.client.connector.connect({chainId:this.config.supportedChainIds[0],chainType:"cosmos"}),this.client.connector.accounts}}class Ut{constructor({key:t="DeFiLink_session_storage_dapp",supportedChainIds:e}){this.key=void 0,this.supportedChainIds=void 0,this.getSession=()=>{const t=s(this.key);return(e=t)&&void 0!==e.bridge&&void 0!==e.chainId&&void 0!==e.chainType&&void 0!==e.wallets&&void 0!==e.wallets&&void 0!==e.wallets[0]&&void 0!==e.wallets[0].addresses&&void 0!==e.wallets[0].addresses.eth&&void 0!==e.accounts&&e.accounts.length>0&&this.supportedChainIds.includes(t.chainId)?t:null;var e},this.setSession=t=>(this.supportedChainIds.includes(t.chainId)&&c(this.key,t),t),this.removeSession=()=>{h(this.key)},this.key=t,this.supportedChainIds=e}}var Pt;!function(t){t.Update="DeFiConnectorUpdate",t.Error="DeFiConnectorError",t.Deactivate="DeFiConnectorDeactivate"}(Pt||(Pt={}));const Dt=t=>"eth"===t||"cosmos"===t?t:"eth";class Rt extends P{constructor(t){super(),this.config=void 0,this.eventEmitters=[],this.connectorClient=void 0,this._provider=void 0,this.chainId="",this.chainType="eth",this.accounts=[],this.config=t}async getProvider(){return this.provider}async getChainId(){return this.chainId}async getAccount(){return this.accounts[0]}get _supportedChainIds(){var t,e,n,i;const o=null!=(t=null==(e=this.config.eth)?void 0:e.supportedChainIds.map(t=>t.toString()))?t:[],r=null!=(n=null==(i=this.config.cosmos)?void 0:i.supportedChainIds)?n:[];return o.concat(r)}async generateClient(){var t=this;let e;if(await async function(t=0){return new Promise(e=>{!function n(){t>0&&"function"!=typeof window.deficonnectClientGenerator?setTimeout(async function(){--t,n()},100):e(!0)}()})}(10),"function"==typeof window.deficonnectClientGenerator)e=await window.deficonnectClientGenerator(this.config),void 0===e.clearSessionStorage&&(e.clearSessionStorage=z.prototype.clearSessionStorage);else{var n;const t={bridge:$(null!=(n=this.config.bridge)?n:"https://wallet-connect.crypto.com/api/v1/ncwconnect/relay/ws",{role:"dapp",dapp_name:this.config.name}),qrcodeModal:ut},i=new Ut({supportedChainIds:this._supportedChainIds});e=new z({connectorOpts:t,sessionStorage:i})}return e.connector.on("disconnect",()=>{this.emitDeactivate()}),e.connector.on("session_update",async function(n,i){var o;if(n)return void t.emitError(n);if(null==i||!i.params[0])return;const{params:[{chainId:r,chainType:s,accounts:c}]=[]}=i;r&&s&&c&&(t.chainId=r,t.chainType=s,t.accounts=c,t.provider=await t.generateProvider({chainId:r,chainType:s,connectorClient:e,config:t.config}),await(null==(o=t.provider)?void 0:o.enable()),t.emitUpdate({account:c[0],chainType:s,chainId:r,provider:t.provider}))}),e}async generateProvider(t){const{chainId:e,chainType:n,connectorClient:i}=t;if("function"==typeof window.deficonnectProviderGenerator)return await window.deficonnectProviderGenerator({chainId:e,chainType:n,config:this.config,connectorClient:i});if("eth"===n)return new u(D({},this.config.eth,{connector:i.connector}));var o,r;if("cosmos"===n)return new qt({supportedChainIds:null!=(o=null==(r=this.config.cosmos)?void 0:r.supportedChainIds)?o:[],client:i});throw new Error("must provider eth or cosmos config")}async activate(){try{var t;let i=this.connectorClient;if(i||(i=await this.generateClient()),0==this.config.supprtedChainTypes.length)throw new Error("must provider supprtedNetworks");const o=this.config.supprtedChainTypes[0];let r="1";if("eth"===o){var e;if(null==this.config.eth)throw new Error("must provider eth config");r=`${null!=(e=this.config.eth.supportedChainIds[0])?e:1}`}if("cosmos"===o){var n;if(null==this.config.cosmos)throw new Error("must provider cosmos config");r=`${null!=(n=this.config.cosmos.supportedChainIds[0])?n:1}`}const{chainId:s,chainType:c,accounts:h}=await i.connector.connect({chainId:r,chainType:o});return this.chainId=s,this.chainType=Dt(c),this.accounts=h,this.provider=await this.generateProvider({chainId:s,chainType:c,connectorClient:i,config:this.config}),await(null==(t=this.provider)?void 0:t.enable()),this.connectorClient=i,{account:h[0],chainType:Dt(c),chainId:s,provider:this.provider}}catch(t){throw console.error("DeFiConnector activate error:",t),t}}getAddressList(t){const e=this.connectorClient;if(!e)throw new Error("you has not active this connector");return t.map(t=>({type:t,address:e.connector.session.wallets[0].addresses[t].address}))}async close(){var t;null==(t=this.connectorClient)||t.clearSessionStorage();try{var e;await(null==(e=this.provider)?void 0:e.close())}finally{var n;await(null==(n=this.connectorClient)?void 0:n.connector.killSession())}}async deactivate(){var t,e,n,i;null==(t=this.connectorClient)||t.clearSessionStorage(),"function"==typeof(null==(e=this.provider)?void 0:e.stop)&&(null==(i=this.provider)||i.stop()),await(null==(n=this.connectorClient)?void 0:n.connector.killSession()),this.emitDeactivate()}get provider(){return this._provider}set provider(t){this._provider=t}onEvent(t,e){const n={event:t,callback:e};return this.eventEmitters.push(n),()=>{this.eventEmitters=this.eventEmitters.filter(t=>t!==n)}}emitUpdate(t){this.eventEmitters.forEach(e=>{e.event===Pt.Update&&e.callback(t,void 0)})}emitError(t){this.eventEmitters.forEach(e=>{e.event===Pt.Error&&e.callback(void 0,t)})}emitDeactivate(){this.eventEmitters.forEach(t=>{t.event===Pt.Deactivate&&t.callback(void 0,void 0)}),this.connectorClient=void 0}}const $t="URI_AVAILABLE";class Ft extends Error{constructor(){super(),this.name=this.constructor.name,this.message="The user rejected the request."}}function Vt({supportedChainIds:t,rpc:e}){return t||(e?Object.keys(e).map(t=>Number(t)):void 0)}function Gt(t){try{const e=parseInt(null!=t?t:"0");return isNaN(e)?0:e}catch(t){return 0}}class Zt extends P{constructor(t){var e,n,i;super({supportedChainIds:Vt(t)}),this.defiConnector=void 0,this._injectConnect=void 0;const o=a()||void 0;this.defiConnector=new Rt({name:null!=(e=null==o?void 0:o.name)?e:"",supprtedChainTypes:["eth"],bridge:t.bridge,eth:t}),this.defiConnector.onEvent(Pt.Update,t=>{if(!t)return;const{chainId:e,provider:n,account:i}=t;this.emitUpdate({chainId:Gt(e),provider:n,account:i})}),this.defiConnector.onEvent(Pt.Deactivate,()=>{this.emitDeactivate()}),null!=(n=navigator)&&null!=(i=n.userAgent)&&i.includes("DeFiWallet")&&window.ethereum&&(this._injectConnect=new b({supportedChainIds:t.supportedChainIds}))}async activate(){if(this._injectConnect)return await this._injectConnect.activate();const{chainId:t,provider:e,account:n}=await this.defiConnector.activate();return{chainId:Gt(t),provider:e,account:n}}async getProvider(){return this._injectConnect?await this._injectConnect.getProvider():this.defiConnector.provider}async getChainId(){return this._injectConnect?await this._injectConnect.getChainId():Gt(this.defiConnector.chainId)}async getAccount(){return this._injectConnect?await this._injectConnect.getAccount():(await this.getProvider()).send("eth_accounts").then(t=>t[0])}close(){return this.defiConnector.close()}deactivate(){if(this._injectConnect)return this._injectConnect.deactivate();this.defiConnector.deactivate()}}export{Rt as DeFiConnector,z as DeFiConnectorClient,Pt as DeFiConnectorUpdateEvent,qt as DeFiCosmosProvider,Zt as DeFiWeb3Connector,$t as URI_AVAILABLE,Ft as UserRejectedRequestError,$ as addUrlParams,G as formatToCWEURI,Z as formatToWCURI,F as formatUriAddUrlParams,Mt as isDeFiCosmosProvider,J as limitWords,R as removeAllUrlParams,V as replaceUriProtocol};
//# sourceMappingURL=index.modern.js.map
